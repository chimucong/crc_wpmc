//
// Created by test on 7/18/18.
//

#ifndef CRC_WPMC_CRC32C_H
#define CRC_WPMC_CRC32C_H

#include "Crc32Base.h"

//% CRC32C 32 28 27 26 25 23 22 20 19 18 14 13 11 10 9 8 6 0
//a = [1 0 0 0 0 0 1 0 1 1 1 1 0 1 1 0 0 0 1 1 1 0 1 1 0 1 1 1 1 0 0 0 1]; %0x82F63B78
//b = [repelem(0,64),1];
//[q,r] =  gfdeconv(b,a);
//q
//% 0     1(31)     1(30)     0     1(28)     1(27)     1(26)     1(25)
//% 0     1(23)     0     1(21)     0     0     1(18)     1(17)
//% 1(16)     0     0     0     1(12)     0     0     1(9)
//% 1(8)     1(7)     1(6)     1(5)     1(4)     0     0     0     1(0)
class Crc32C : public Crc32Base {
public:
    Crc32C() : Crc32Base(0x82F63B78) {}

    uint32_t mod(uint32_t p) {
        p = p ^ (p << 31) ^ (p << 30) ^ (p << 28) ^ (p << 27) ^ (p << 26) ^ (p << 25)
            ^ (p << 23) ^ (p << 21) ^ (p << 18) ^ (p << 17)
            ^ (p << 16) ^ (p << 12) ^ (p << 9)
            ^ (p << 8) ^ (p << 7) ^ (p << 6) ^ (p << 5) ^ (p << 4);
        p = p ^ (p >> 28) ^ (p >> 27) ^ (p >> 26) ^ (p >> 25) ^ (p >> 23) ^ (p >> 22) ^ (p >> 20)
            ^ (p >> 19) ^ (p >> 18) ^ (p >> 14) ^ (p >> 13) ^ (p >> 11) ^ (p >> 10)
            ^ (p >> 9) ^ (p >> 8) ^ (p >> 6);
        return p;

    }

};


#endif //CRC_WPMC_CRC32C_H
